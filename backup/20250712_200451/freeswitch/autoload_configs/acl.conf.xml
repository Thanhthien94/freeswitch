<configuration name="acl.conf" description="Network Lists">
  <network-lists>
    <!--
	 These ACL's are automatically created on startup.

	 rfc1918.auto  - RFC1918 Space
	 nat.auto      - RFC1918 Excluding your local lan.
	 localnet.auto - ACL for your local lan.
	 loopback.auto - ACL for your local lan.
    -->

    <!-- Production LAN ACL -->
    <list name="lan" default="deny">
      <node type="allow" cidr="192.168.0.0/16"/>
      <node type="allow" cidr="10.0.0.0/8"/>
      <node type="allow" cidr="172.16.0.0/12"/>
      <node type="allow" cidr="127.0.0.1/32"/>
    </list>

    <!-- PBX Network ACL for Docker containers -->
    <list name="pbx_network" default="deny">
      <node type="allow" cidr="172.25.0.0/16"/>
      <node type="allow" cidr="127.0.0.1/32"/>
      <node type="allow" cidr="::1/128"/>
      <!-- Docker Desktop host IP -->
      <node type="allow" cidr="192.168.65.0/24"/>
      <!-- Host machine access -->
      <node type="allow" cidr="192.168.1.0/24"/>
    </list>

    <!-- ESL Access Control -->
    <list name="esl_access" default="allow">
      <!-- Allow all for ESL debugging -->
    </list>

    <!--
	This will traverse the directory adding all users
	with the cidr= tag to this ACL, when this ACL matches
	the users variables and params apply as if they
	digest authenticated.
    -->
    <list name="domains" default="deny">
      <!-- domain= is special it scans the domain from the directory to build the ACL -->
      <node type="allow" domain="$${domain}"/>
      <node type="allow" domain="localhost"/>
      <node type="allow" domain="pbx.local"/>
      <!-- Allow Docker network for SIP registration -->
      <node type="allow" cidr="172.25.0.0/16"/>
      <!-- Allow local network for SIP registration -->
      <node type="allow" cidr="192.168.0.0/16"/>
      <node type="allow" cidr="10.0.0.0/8"/>
    </list>

    <!-- SIP Profile ACL -->
    <list name="sip_profiles" default="deny">
      <node type="allow" cidr="172.25.0.0/16"/>
      <node type="allow" cidr="192.168.0.0/16"/>
      <node type="allow" cidr="10.0.0.0/8"/>
      <node type="allow" cidr="127.0.0.1/32"/>
    </list>

  </network-lists>
</configuration>

